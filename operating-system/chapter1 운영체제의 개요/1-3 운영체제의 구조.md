# 1-3. 운영체제의 구조

## 1. 커널과 인터페이스

> 운영체제는 크게 커널과 인터페이스로 나뉨
> 
- **커널**: 운영체제의 핵심적인 기능을 모아놓은 것
    - 프로세스 관리, 메모리 관리, 저장장치 관리
    - 자동차의 경우엔 엔진
- **인터페이스**: 커널에 사용자의 명령을 전달하고 실행 결과를 사용자에게 알려주는 역할

- 같은 커널을 사용하더라도 다른 인터페이스를 가진 형태로 제작할 수 있음
    - 사용자에게는 다른 운영체제처럼 보임
    - 예시)
        - 유닉스의 사용자 인터페이스 셸은 명령어 기반
        - 매킨토시 운영체제 Mac OS X도 유닉스 계열의 커널을 이용해서 만든 것

## 2. 시스템 호출과 디바이스 드라이버

<aside>
💡 **시스템 호출**: 응용프로그램과 커널의 인터페이스
**드라이버**: 커널과 하드웨어의 인터페이스

</aside>

### 시스템 호출

- **시스템 호출**(system call): **커널이 자신을 보호하기 위해** 만든 인터페이스
    - 커널은 사용자나 응용 프로그램으로부터 컴퓨터 자원을 보호하기 위해 자원에 **직접 접근을 차단**
    - 자원을 이용하려면 시스템 호출을 사용해야함(사용자가 커널 영역에 접근할 수 있는 유일한 수단)
    - 커널이 제공하는 시스템 관련 서비스를 모아놓은 것
    - 함수 형태로 제공

- 자원에 직접 접근 vs 시스템 호출을 통해 접근
    - 직접 접근
        - 사용자가 직접 컴퓨터 자원에 접근하여 작업
        - 사용자가 모든 것을 처리
        - 자원 보호가 어려움
    - 시스템 호출을 통한 접근
        - 누군가에게 요청하여 작업의 결과만 받는 방식
        - 사용자나 응용 프로그램이 하드웨어와 같은 시스템 자원을 사용할 수 있도록 시스템 호출 인터페이스 제공 (직접 접근은 차단)

- 응용 프로그램 입장에서 시스템 호출
    - 두 응용 프로그램이 각각 다른 숫자를 하드디스크에 저장한다고 가정
    - 직접 접근
        - 두 응용 프로그램이 각각 원하는 곳에 데이터 저장
        - 다른 사람의 데이터가 훼손 될 수 있음
    - 시스템 호출
        - 커널이 제공하는 `write()` 함수를 사용하여 데이터를 저장해달라고 요청
        - 저장한 데이터를 읽고 싶다면 `read()` 함수 사용
        - 커널이 모든 것을 책임

- API(Application Programming Interface) 응용 프로그램 인터페이스
    - 응용 프로그램이 자신과 연관된 프로그램을 만들 수 있도록 제공하는 인터페이스
    - API는 시스템 호출보다 광범위한 개념
    - **운영체제의 API는 시스템 호출**
    - 포토샵의 수백 가지 필터 모두가 포토샵에서 제공되는 게 아닌 것처럼

- SDK(System Developer’s Kit) 시스템 개발자용 키트
    - 프로그램 개발자를 위해 API 및 API 사용 매뉴얼뿐만 아니라 프로그램 개발에 필요한 코드 편집기와 에뮬레이터 같은 각종 개발용 응용 프로그램까지 **하나로 묶어서 배포**하는 개발 툴
    

### 드라이버

- 드라이버: 커널과 하드웨어의 인터페이스
- 디바이스 드라이버: 하드웨어 제작자가 만든 소프트웨어
    - 모든 하드웨어에 맞는 인터페이스를 다 개발하기는 어려움
    - 따라서 커널은 입출력의 기본적인 부분만 제작
    - 하드웨어의 특성을 반영한 소프트웨어를 제작 후 커널과 함께 실행
    - 마우스, 키보드, 프린터, 그래픽카드 ..

- 커널이 제공하는 드라이버도 있고 하드웨어 제작자가 제공하는 드라이버도 있음
    - 하드웨어는 커널과 직접 연결되기도 하고, 하드웨어 제작자가 제공하는 드라이버를 통해 연결되기도 함

## 3. 커널의 구성

- 커널이 하는 일
    - 프로세스 관리, 메모리 관리, 파일 시스템 관리, 입출력 관리, 프로세스 간 통신

- 프로세스 관리: **프로세스에 CPU를 배분**하고 **작업에 필요한 제반 환경 제공**
- 메모리 관리: **프로세스에 작업 공간을 배치**하고 실제 메모리보다 큰 **가상공간** 제공
- 파일 시스템 관리: **데이터**를 **저장**하고 **접근**할 수 있는 인터페이스 제공
- 입출력 관리: 필요한 입력과 출력 서비스 제공
- 프로세스 간 통신 관리: **공동작업**을 위한 각 프로세스 간 통신 환경 지원

### 단일형 구조 커널

- 초창기의 운영체제 구조
- 커널의 핵심 기능을 구현하는 모듈들이 구분 없이 하나로 구성
- MS-DOS, VMS, 유닉스

- 장점
    - 모듈 간의 통신 비용이 줄어듦(하나로 합쳐있기 때문) ⇒ 효율적 운영 가능
- 단점
    - 버그나 오류 처리가 어려움
    - 상호 의존성이 높음 ⇒ 기능상 작은 결함이 시스템 전체로 확산 가능
    - 다양한 환경의 시스템에 적용하기 어려움(이식성이 낮음)
    - 현대의 운영체제는 매우 크고 복잡 ⇒ 완전 단일형 구조의 운영체제를 구현하기가 어려움

### 계층형 구조 커널

- **비슷한 기능을 가진 모듈**을 묶어서 하나의 계층으로 만들고 **계층 간의 통신**을 통해 운영체체를 구현
- 오늘날 운영체제의 구조

- 장점
    - 비슷한 기능을 모아 모듈화 ⇒ 버그나 오류 쉽게 처리
    - 디버깅이 쉬움
    

### 마이크로 구조 커널

- 가장 기본적인 기능만 제공
- 다른 커널에 비해 운영체제의 많은 부분이 사용자 영역에 구현됨
- 각 모듈이 세분화 되어 존재
    - 모듈 간의 정보 교환은 프로세스 간 통신을 이용하여 이루어짐

- 장점
    - 하나의 모듈이 실패하더라도 전체 운영체제가 멈추지 않음
    - 많은 컴퓨터에 이식하기 쉽고 커널이 가벼움
    - CPU 용량이 작은 시스템에도 적용 가능

## 4. 가상머신

- 유닉스는 C언어로 만듦
    - C언어로 만든 유닉스와 다른 언어로 만들어진 운영체제와 호환성이 떨어짐

- 자바는 대부분의 운영체제에서 작동
- 자바의 원리
    - 운영체제 위에 가상머신을 만들고 그 위에서 운영 프로그램이 작동하게 함
- 자바는 유닉스와 윈도우에서 작동하는 다양한 가상머신을 만들어 배포함 (JVM)

- 가상머신
    - 응용 프로그램이 모두 동일한 환경에서 작동하는 것처럼 보임